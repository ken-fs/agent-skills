---
name: auto-writing
description: Master-level automated writing system for tech blog articles and tutorials. Creates high-quality, human-like Chinese tech content through multi-source research, outline generation, philosophical writing approach, and multi-dimensional review. Use when user wants to write tech blog posts, tutorials, or popular science articles about AI/technology topics. Triggers on requests like "写一篇关于xxx的文章", "创作技术科普", or when user provides a topic keyword for article creation.
---

# 自动化写作 Skill

大师级科普文章全流程创作系统。

## 核心能力

- **全流程自动化**：从主题到成稿一气呵成
- **多源深度调研**：整合Web、X、Reddit、公众号、小红书
- **写作哲学驱动**：说人话、有温度、有洞察、有节制
- **大师级风格**：卡夫卡的精准 + 余华的朴素 + 马尔克斯的神奇
- **反AI味处理**：7维度审核确保真实自然
- **智能配图**：Gemini API自动生成
- **公众号友好**：格式优化，可直接使用
- **富文本自动输出**：自动生成HTML格式，无需确认

## 触发时机

当用户：
- 说 "写一篇关于xxx的文章"
- 请求创作技术科普、博客文章
- 提供主题关键词并要求写作
- 想要深度研究某个AI/技术话题并生成文章

---

## 完整工作流程

### 阶段0: 需求收集

**立即询问用户（使用AskUserQuestion工具）：**

```
问题1: 请提供文章主题关键词
- 提供输入框

问题2: 选择字数档位
- A. 精炼版（1200-2000字，2-3个金句，2-3个Section）
- B. 标准版（2000-4000字，3-5个金句，3-4个Section）
- C. 深度版（4000-7000字，5-7个金句，4-6个Section）
- D. 长文版（7000-10000字，6-8个金句，5-8个Section）

问题3: 是否有参考文案？
- 提供输入框（可选）
```

收到信息后，简短确认：
```
✅ 收到！我将为你创作：
- 主题：[用户输入]
- 档位：[字数档位]
- 参考：[有/无]

现在开始深度调研...
```

---

### 阶段1: 多源深度调研

**目标：**收集写作素材，建立深度理解

**执行顺序：**

1. **Web搜索（基础信息层）**
   - 搜索：`[主题] + 2026`
   - 搜索：`[主题] + tutorial OR 教程`
   - 搜索：`[主题] + official documentation OR 官方文档`
   - 提取：核心定义、技术特点、官方资料

2. **X平台（英文技术讨论层）**
   - 搜索：`[主题英文] + #AI`
   - 搜索：`[主题] best practices`
   - 提取：技术大V观点、社区讨论、实用技巧

3. **Reddit（社区案例层）**
   - 搜索：r/MachineLearning, r/artificial, r/programming
   - 关键词：`[主题] experience`, `[主题] beginner`
   - 提取：真实案例、常见问题、用户体验

4. **公众号（中文优质内容层）**
   - 搜索：`[主题] 教程`, `[主题] 实战`, `[主题] 深度解析`
   - 提取：中文表达方式、本土化案例、深度文章

5. **小红书（用户体验层）**
   - 搜索：`[主题] 小白`, `[主题] 避坑`, `[主题] 推荐`
   - 提取：通俗理解、实用技巧、真实感受

**调研输出（内部使用，不展示给用户）：**

整合为结构化笔记：
```
【调研结果】
1. 核心概念和定义（用自己的话重写）
2. 技术发展脉络
3. 关键洞察点（3-5个，体现"为什么"和"所以呢"）
4. 真实案例和场景（2-3个具体案例）
5. 常见误区和坑点（2-3个）
6. 有价值的金句或观点（5-10条，用于激发创作）
7. 可视化需求点（2-3个需要配图的位置）
```

**用户反馈：**
```
✅ 调研完成！已整合来自Web、X、Reddit、公众号、小红书的信息
   关键洞察：[1-2句话总结核心发现]

正在生成大纲...
```

**详细调研策略：**
参见 [references/research_strategy.md](references/research_strategy.md)

---

### 阶段2: 大纲生成与审核

**自动生成大纲：**

根据调研结果和字数档位，生成结构化大纲：

```markdown
# [文章标题]（吸引人、有悬念、<20字）

## 一、[开篇导入]（场景化/故事化/问题化）
- 用具体场景/故事/问题引入
- 避免"在当今社会"等AI味开头
- 篇幅：200-400字

## 二、[核心概念解析]
### 2.1 [子主题1]
### 2.2 [子主题2]
...

## 三、[深度解读/实战应用]
### 3.1 [子主题1]
### 3.2 [子主题2]
...

## 四、[进阶内容/注意事项]（可选，根据字数档位）
### 4.1 [子主题1]
...

## 五、[总结与展望]
- 回归开篇场景
- 给出行动建议
- 篇幅：200-300字

---

【配图计划】
- 位置1：[Section名称] - [图片主题描述]
- 位置2：[Section名称] - [图片主题描述]
- 位置3：[Section名称] - [图片主题描述]

【金句计划】
- 金句1：开篇第一段 - [预设主题/方向]
- 金句2：[Section名称]核心洞察后 - [预设主题/方向]
- 金句3：文章结尾 - [预设主题/方向]
...（根据字数档位规划数量）
```

**展示给用户审核：**

```
📝 大纲已生成！请审核：

[展示完整大纲]

---
请选择：
1. ✅ 确认，开始写作
2. ✏️ 我想调整大纲（请直接告诉我修改意见）
```

**等待用户反馈：**
- 如果确认：进入写作阶段
- 如果调整：根据反馈修改大纲，再次展示，直到确认

---

### 阶段3: 文章写作

**加载写作指南：**

在开始写作前，加载以下参考文档到上下文：
- `references/writing_philosophy.md` - 四大原则和风格融合
- `references/forbidden_list.md` - AI写作禁止清单
- `references/golden_sentence_guide.md` - 金句创作指南

**写作核心原则（来自写作哲学）：**

1. **说人话** - 你奶奶能听懂
   - 用类比、故事、短句
   - 技术术语必须解释
   - 避免堆砌专业词汇

2. **有温度** - 真实的人在分享
   - 使用第一人称（我）和第二人称（你）
   - 分享个人经验和感受
   - 承认不完美和局限性
   - 用口语化连接词

3. **有洞察** - 不只"是什么"，更要"为什么"和"所以呢"
   - 三层深度：What → Why → So What
   - 揭示反常识的点
   - 提供行动指南

4. **有节制** - 金句在恰当时刻闪光
   - 严格控制金句数量（见字数档位）
   - 金句间隔2-3段
   - 不为金句而金句

**风格融合（写作时刻保持）：**

- **卡夫卡的精准**：技术术语准确、逻辑严密、每个词必要
- **余华的朴素**：短句为主、用词简单、无华丽修辞
- **马尔克斯的神奇**：意外的比喻、让技术有故事性、平凡变神奇

**禁止清单（写作时避免）：**

严格禁止使用：
- ❌ "首先、其次、最后"
- ❌ "值得注意的是"、"需要指出的是"
- ❌ "总而言之"、"综上所述"
- ❌ "让我们来看看"
- ❌ "众所周知"、"显而易见"
- ❌ "在当今社会"、"随着科技发展"
- ❌ 过度排比（连续3段以上）
- ❌ 过多感叹号（全文<5个）

详见：`references/forbidden_list.md`

**写作流程：**

按照确认的大纲，逐Section写作：

1. **开篇导入（200-400字）**
   - 用场景、故事或问题开场
   - 第一段必须抓住注意力
   - 自然引入主题
   - **金句位置**：开篇第一段结尾

2. **主体内容（按Section）**
   - 每个Section按大纲展开
   - 遵循"说人话、有温度、有洞察、有节制"
   - 穿插具体案例和例子
   - **金句位置**：核心洞察之后、段落/小节结尾
   - 预留配图位置：标注 `[图片：xxx描述]`

3. **结尾（200-300字）**
   - 回归开篇场景/问题
   - 给出具体行动建议（不是空洞号召）
   - 留有余味（提问/洞察）
   - **金句位置**：文章最后

**字数分配（参考）：**

| 档位 | 开篇 | 主体 | 结尾 | 总计 |
|------|------|------|------|------|
| A. 精炼版 | 200-300 | 800-1400 | 200-300 | 1200-2000 |
| B. 标准版 | 300-400 | 1400-3200 | 300-400 | 2000-4000 |
| C. 深度版 | 400-600 | 3000-6000 | 400-600 | 4000-7000 |
| D. 长文版 | 500-800 | 6000-8500 | 500-700 | 7000-10000 |

**写作时的用户反馈：**
```
✍️ 正在写作中...
   已完成：[Section名称]

[全部完成后]
✅ 初稿完成！正在进行多维度审核...
```

---

### 阶段4: 多维度自审

**目标：**确保文章达到大师级标准

**加载审核标准：**
`references/review_dimensions.md`

**7维度审核清单：**

1. **可读性 (Readability)**
   - 句子长度（平均<25字）
   - 段落结构（3-5句/段）
   - 过渡自然
   - 评分标准：1-10分

2. **技术准确性 (Technical Accuracy)**
   - 概念定义正确
   - 术语使用规范
   - 数据有来源
   - 案例真实
   - **必须≥9分**

3. **逻辑连贯性 (Logical Coherence)**
   - 论证链条完整
   - 因果关系清晰
   - 结构严密
   - 无逻辑跳跃

4. **反AI味 (Human-like Writing)**
   - 检查禁止清单（所有禁止词出现次数）
   - 是否有温度和个性
   - 是否像人写的
   - **必须≥7分**

5. **风格一致性 (Style Consistency)**
   - 卡夫卡的精准
   - 余华的朴素
   - 马尔克斯的神奇
   - 风格统一

6. **受众匹配度 (Audience Fit)**
   - 普通大众能懂（术语有解释）
   - 程序员感兴趣（有代码/技术细节）
   - AI爱好者想深入（有前沿趋势）
   - 难度递进

7. **吸引力 (Engagement)**
   - 标题吸引人
   - 开篇抓眼球
   - 金句恰到好处
   - 结尾有余味

**自审输出：**

生成审核报告：

```markdown
📊 自审报告：

| 维度 | 得分 | 状态 |
|------|------|------|
| 1. 可读性 | 8/10 | ✅ 通过 |
| 2. 技术准确性 | 9/10 | ✅ 通过 |
| 3. 逻辑连贯性 | 7/10 | ✅ 通过 |
| 4. 反AI味 | 6/10 | ⚠️ 需优化 |
| 5. 风格一致性 | 8/10 | ✅ 通过 |
| 6. 受众匹配度 | 9/10 | ✅ 通过 |
| 7. 吸引力 | 7/10 | ✅ 通过 |
| **平均分** | **7.7/10** | ✅ 合格 |

---

【详细分析】

### 维度4: 反AI味 (6/10) - 需优化

**发现问题：**
1. 第2段使用"首先...其次...最后..."
2. 第5段出现"值得注意的是"
3. 金句密度偏高（8句/3000字）

**优化建议：**
1. 改写第2段，用自然过渡代替"首先其次"
2. 删除"值得注意的是"，直接说内容
3. 删除2个金句，保留最精彩的

### 其他亮点
- 技术准确性高，所有概念验证无误
- 案例贴合受众，覆盖不同背景

---

是否需要我根据建议优化文章？
```

**自动优化：**

如果任何维度<7分：
1. 根据审核建议自动优化
2. 再次评分
3. 直到所有维度≥7分

优化完成后告知用户：
```
✅ 优化完成！所有维度已达标。

正在生成配图...
```

---

### 阶段5: 配图生成

**识别配图位置：**
根据写作阶段标注的 `[图片：xxx]` 位置

**创建日期文件夹：**
在开始生成配图前，先创建日期文件夹：
```bash
# 文件夹命名格式：YYYYMMDD_HHMMSS_[文章标题简称]
# 例如：output/20260127_143025_Clawdbot介绍/
```

**自动生成图片：**

使用 `scripts/generate_image.py` 调用 **Gemini 3 Pro Image** 自动生成到日期文件夹：

```bash
# 单张生成（保存到日期文件夹）
python scripts/generate_image.py "提示词" output/20260127_143025_Clawdbot介绍/image1.jpg

# 批量生成
python scripts/generate_image.py --batch prompts.json output/20260127_143025_Clawdbot介绍/
```

**配置信息：**
- 模型：`gemini-3-pro-image` (支持图片生成)
- API endpoint: `http://127.0.0.1:8045` (代理地址)
- 输出格式：JPG/PNG
- 默认尺寸：1024x1024
- **保存位置**：与HTML文件同一日期文件夹

**插画风格规范：**
- **风格**：纯手绘线条风，极简主义
- **线条**：单色细线（深棕 #3D3D3D 或黑色 #1A1A1A），有机、略带抖动感的手绘质感，非机械直线
- **背景**：统一高端米黄色 #F5F0E6
- **填充**：无填充或极淡的同色系晕染
- **文案**：可有少量手写风格英文标注，不超过3个单词
- **禁止**：渐变、阴影、3D效果、复杂纹理、多色彩
- **比例**：16:9 or 4:3 ratio for articles

**用户反馈：**
```
🎨 配图生成中...
   ✓ 图片1：概念解释图 → output/20260127_143025_Clawdbot介绍/image1.jpg
   ✓ 图片2：流程示意图 → output/20260127_143025_Clawdbot介绍/image2.jpg
   ✓ 图片3：场景插画 → output/20260127_143025_Clawdbot介绍/image3.jpg

已保存到日期文件夹！HTML中使用相对路径引用。
```

---

### 阶段6: 最终输出

**生成摘要：**
```
【摘要】（100-150字）
用1-2句话概括文章核心内容，吸引读者点击。
```

**生成导读：**
```
【导读】（200-300字）

**你将学到：**
- 要点1（具体）
- 要点2（具体）
- 要点3（具体）

**为什么值得读：**
[1-2句话说明独特价值]

**适合谁读：**
[目标读者描述]

**预计阅读时间：**[根据字数计算] 分钟
```

**公众号格式优化：**

使用 `scripts/wechat_formatter.py` 或参考 `assets/wechat_template.md`：

- 标题层级优化（H2, H3）
- 金句用引用块高亮：`> ✨ 金句内容`
- 代码块格式化
- 图片格式优化
- 段落间距调整

**自动生成富文本HTML：**

完成文章输出后，自动生成富文本HTML格式文件，保存到 `output/` 目录的**日期文件夹**中：

**文件组织结构：**
- 创建日期文件夹：`output/YYYYMMDD_HHMMSS_[文章标题简称]/`
  - 例如：`output/20260127_143025_Clawdbot介绍/`
- HTML文件：`[文章标题]_富文本.html`
- 配图文件：所有生成的图片（`image1.jpg`, `image2.jpg`等）
- 图片引用：HTML中使用相对路径（同目录下）

**HTML样式规范：**
- 使用Write工具创建完整的HTML文件
- 包含完整的CSS样式（适合公众号、博客）
- 响应式设计，移动端友好
- **配色方案**：浅色棕色主题（白色背景 #FFFFFF、浅灰背景 #F8F8F8、深色文字 #1A1A1A、棕色主题色 rgb(149, 56, 0)）
- **金句高亮**：浅棕色背景 #FFF8F0 + 左侧棕色边框 + 引号装饰
- **信息框**：浅棕色背景 #FFF8F0 + 绿色边框 #22c55e（提示）、浅棕色背景 + 橙色边框 #f59e0b（警告）
- **代码块**：浅灰背景 #F5F5F5，圆角设计，细边框
- **配图展示**：使用.illustration类包裹，浅棕色背景，带边框装饰
- **一键复制按钮**：底部添加"一键复制到公众号"棕色圆角按钮

**一键复制功能（重要技术说明）：**

使用 `document.execCommand('copy')` + 样式内联的方式，确保微信公众号能保留格式：

**核心原理：**
- ❌ 不使用 `navigator.clipboard.write()` - 对富文本样式支持不完整
- ✅ 使用 `document.execCommand('copy')` - 传统方法但对富文本更可靠
- ✅ 所有CSS样式内联到每个元素的 `style` 属性中
- ✅ 创建临时DOM元素进行复制

**实现代码模板：**
```javascript
function copyArticle() {
    const container = document.querySelector('.container');

    // 创建临时div用于复制
    const tempDiv = document.createElement('div');
    tempDiv.style.position = 'absolute';
    tempDiv.style.left = '-9999px';
    document.body.appendChild(tempDiv);

    // 克隆内容并移除按钮
    const clone = container.cloneNode(true);
    clone.querySelector('.copy-button').remove();
    clone.querySelector('.toast').remove();

    // 内联所有样式到元素上（关键！）
    applyInlineStyles(clone);
    tempDiv.appendChild(clone);

    // 选中新创建的内容
    const range = document.createRange();
    range.selectNodeContents(tempDiv);
    const selection = window.getSelection();
    selection.removeAllRanges();
    selection.addRange(range);

    // 执行复制
    document.execCommand('copy');

    // 清理
    selection.removeAllRanges();
    document.body.removeChild(tempDiv);
    showToast();
}

function applyInlineStyles(element) {
    // 为每个元素应用内联样式
    const styleMap = {
        'h1': 'font-size: 28px; font-weight: 700; ...',
        'h2': 'font-size: 22px; font-weight: 600; ...',
        'p': 'margin-bottom: 20px; line-height: 1.8; ...',
        // ... 更多样式映射
    };

    const elements = element.querySelectorAll('*');
    elements.forEach(el => {
        const tagName = el.tagName.toLowerCase();
        if (styleMap[tagName]) {
            el.setAttribute('style', styleMap[tagName]);
        }
    });
}
```

**微信公众号兼容性注意事项：**
- 公众号编辑器**不支持**：背景色、边框、复杂段落间距
- 公众号编辑器**支持**：加粗、斜体、引用块、标题格式
- 建议提供两个版本：完整版（带样式）和公众号版（使用原生 `<blockquote>`）

**用户反馈：**
```
📄 文章已生成并保存到日期文件夹！

📁 文件夹位置：
C:\Users\Administrator\.claude\skills\auto-writing\output\20260127_143025_Clawdbot介绍\

📄 包含文件：
- Clawdbot_住在聊天工具里的AI助手_富文本.html
- clawdbot_diagram_1.jpg
- [其他配图文件...]

💡 使用提示：
1. 双击HTML文件在浏览器中预览
2. 点击"一键复制到公众号"按钮
3. 图片已使用相对路径，与HTML在同一文件夹
4. 整个文件夹可以直接分享或备份
```

**最终交付格式：**

```markdown
🎉 文章创作完成！

---

# [文章标题]

## 【摘要】
[摘要内容]

## 【导读】
[导读内容]

---

[完整文章内容 - 已优化为公众号格式]

---

📊 文章数据：
- 字数：[实际字数]
- 段落：[段落数]
- 配图：[配图数量]
- 金句：[金句数量]
- 预计阅读时间：[x分钟]

📋 审核评分：
- 平均分：[总分]/10
- 所有维度≥7分 ✅

📋 一键复制：
- 底部浅色棕色风格圆角按钮
- 点击自动复制全部内容
- 含样式、含图片、含格式
- 直接粘贴即可使用

---

💡 使用提示：
1. **一键复制**：点击底部"一键复制到公众号"按钮
2. 直接粘贴到公众号编辑器
3. 图片已内嵌，无需单独上传
4. 样式已保留，格式完整

---

🎯 下一步：
- 想要调整内容？告诉我修改意见
- 想要不同风格？可以重新生成
- 满意的话可以直接发布！

---

📄 **富文本HTML已自动生成并保存到 output/ 目录**
```

**重要提示：**
- 富文本HTML生成是默认步骤，无需用户确认
- 每次文章创作完成后自动生成
- 文件包含完整样式，可直接用于公众号、博客等平台

---

## 字数档位配置

| 档位 | 字数范围 | 金句数量 | Section数 | 配图数量 | 预计创作时间 |
|------|----------|----------|-----------|----------|--------------|
| A. 精炼版 | 1200-2000 | 2-3句 | 2-3个 | 1-2张 | 25-35分钟 |
| B. 标准版 | 2000-4000 | 3-5句 | 3-4个 | 2-3张 | 35-50分钟 |
| C. 深度版 | 4000-7000 | 5-7句 | 4-6个 | 3-4张 | 50-70分钟 |
| D. 长文版 | 7000-10000 | 6-8句 | 5-8个 | 4-5张 | 60-90分钟 |

---

## 配套资源

### Scripts 脚本

1. **generate_image.py** - Gemini API配图生成
   - 单张生成：`python generate_image.py "prompt" output.png`
   - 批量生成：`python generate_image.py --batch prompts.json output_dir/`

2. **multi_source_research.py** - 多源调研整合（可选）
   - 创建调研对象：`ResearchAggregator(topic)`
   - 导出报告：`aggregator.export_json('research.json')`

3. **wechat_formatter.py** - 公众号格式优化
   - 转换文件：`python wechat_formatter.py input.md output.md`

### References 参考文档

1. **writing_philosophy.md** - 写作哲学核心
   - 四大原则详解
   - 风格融合指南
   - 检查清单

2. **forbidden_list.md** - AI写作禁止清单
   - 15类禁止模式
   - 检测方法
   - 修复示例

3. **golden_sentence_guide.md** - 金句创作指南
   - 6种金句类型
   - 创作4步骤
   - 位置和密度控制

4. **research_strategy.md** - 多源调研策略
   - 5大信息源策略
   - 调研执行流程
   - 质量检查清单

5. **review_dimensions.md** - 7维度审核标准
   - 详细评分标准
   - 检查项和修复方法
   - 审核报告模板

### Assets 资源

1. **wechat_template.md** - 公众号排版模板
   - 标准格式
   - 排版说明
   - 复制步骤

---

## 质量保证

### 必达标准

- ✅ 所有维度≥7分
- ✅ 技术准确性≥9分
- ✅ 无AI写作禁止词
- ✅ 金句数量符合档位
- ✅ 字数在档位范围内

### 优秀标准

- 🌟 平均分≥9分
- 🌟 所有维度≥8分
- 🌟 开篇抓人
- 🌟 金句精彩
- 🌟 结尾有余味

---

## 常见问题

**Q: 调研时间太长怎么办？**
A: 可以调整调研深度，精炼版30-40分钟足够。

**Q: 金句写不出来怎么办？**
A: 参考 `references/golden_sentence_guide.md`，使用6种类型模板。

**Q: 如何避免AI味？**
A: 严格遵守 `references/forbidden_list.md`，写完用检测方法验证。

**Q: 配图生成失败怎么办？**
A: 脚本会返回优化后的提示词，可手动使用其他工具生成。

**Q: 文章不符合要求怎么办？**
A: 根据7维度审核报告，针对性优化<7分的维度。

**Q: 富文本HTML文件在哪里？**
A: 自动保存到 `output/` 目录，无需手动请求。每次创作完成后都会生成。

**Q: 一键复制按钮在哪里？**
A: 每个富文本HTML底部都有"一键复制到公众号"按钮，点击即可复制全部内容。

**Q: 复制后的内容可以直接用吗？**
A: 可以！复制到微信公众号编辑器后会保留所有样式（标题、格式、颜色、图片等）。

---

## 最后提醒

**写作的本质：**
用真实的人的声音，分享有价值的洞察。

**不是：**
机械地整理和输出信息。

**目标：**
读者读完后说"写得真好"，而不是"这是AI写的吧"。

**标准：**
你愿意为这篇文章署名。
